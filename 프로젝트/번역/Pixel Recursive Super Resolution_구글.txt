픽셀 재귀 슈퍼 해상도

추상
초 고해상도는 인위적으로 저해상도 사진을 확대하여 그럴듯한 고해상도 버전을 복구하는 문제입니다. 고배율 영역에서, 문제는 극히 미미하며, 그럴듯한 많은 고해상도 이미지가 주어진 저해상도 이미지와 일치 할 수 있습니다. 특히, 전통적인 슈퍼 해상도 기술은 문제의 다중 모달 및 그럴듯한 고해상도 이미지를 생성하기 위해 이미지 합성에 부과되어야하는 강한 사전 정보 때문에이 영역에서 실패합니다.

이 연구에서는이 문제를 해결하기 위해 PixelCNN을 확장 한 새로운 픽셀 확률 슈퍼 네트워크 모델 인 확률 론적 네트워크 구조를 제안한다.

우리는이 모델이 큰 배율 인자에서 그럴듯한 고해상도 이미지의 다양성을 만들어 낸다는 것을 보여줍니다.

또한 인간 평가 연구에서 이전의 방법이 인간 관찰자를 속일 수없는 방법을 보여줍니다. 그러나이 확률 론적 깊은 네트워크에서 샘플링 된 고해상도 이미지는 순진한 인간 관찰자를 상당 부분 시간을 속일 수 있습니다.


1. 소개

수퍼 해상도의 문제는 인위적으로 저해상도 사진을 확대하여 그와 같은 그럴듯한 이미지를 고해상도로 복구하는 것을 포함한다.

작은 배율이 요구 될 때 (예를 들어, 2 배), 초고 해상 기술은 저급 특성을 포착하는 이미지 [35, 2, 51]의 통계적 이전 모델을 구축함으로써 만족스러운 결과를 얻는다 [41, 8, 16, 39, 22] 자연의 이미지.

이 논문은 고해상도 이미지를 정확하게 구성하기 위해 사용할 수있는 정보의 양이 매우 적은 특히 작은 입력 및 큰 배율로 초 고해상도를 연구합니다 (그림 1, 왼쪽 열).

따라서, 문제는 명확하지 않으며 많은 그럴듯한 고해상도 이미지가 주어진 저해상도 입력 이미지와 일치 할 수 있습니다.

고배율 체제에서의 초고 해상 상태의 최첨단 기술에 대한 개선 된 모델을 구축하는 것은 수퍼 해상도에서 최첨단 기술을 개선하고 더 일반적으로 이미지의 조건부 생성 모델을 개선하는 데 중요합니다 [44, 33, 30, 43 ].

==============
• Google Brain Residency 프로그램의 일원으로 일했습니다.
(g.co/brainresidency).

그림 1 : 유명 인사 얼굴의 데이터 세트에서 엔드 투 엔드 (end-to-end)로 훈련 된 확률 론적 픽셀 재귀 슈퍼 해상도 모델의 예 왼쪽 열은 테스트 세트의 8 ~ 8 개의 저해상도 입력을 보여줍니다. 가운데와 마지막 열은 우리 모델과 지상 진상에 의해 예측 된 32 ~ 32 개의 이미지를 보여줍니다.

우리의 모델은 현실적인 머리카락과 피부 세부 사항을 합성하기 위해 강력한 얼굴 사전을 통합합니다.
=============

배율이 증가함에 따라 수퍼 해상도 모델은 텍스처, 에지 및 기타 저급 통계 [16, 39, 22]를 설명 할뿐만 아니라 오브젝트, 시점, 조명 및 교합의 복잡한 변형을 점차 고려해야합니다. 배율이 증가하면 소스 이미지에 세부 사항이 더 이상 존재하지 않으며 세부적인 내용을 복구하는 것이 예측 문제로 바뀝니다

(예 : deconvolution [23]) 그럴듯한 새로운 세부 사항들을 de novo로 합성하는 것 [33, 44].

그림 1의 왼쪽 열에서 얼굴의 저해상도 이미지를 생각해보십시오. 이러한 8-8 픽셀 이미지에서 모발과 피부의 미세한 공간적 세부 사항은 누락되어 보간 기술 [15]을 사용하여 충실하게 복원 할 수 없습니다.

그러나 스케치 아티스트는 얼굴과 그 전형적인 변형에 대한 사전 지식을 통합함으로써 특수 소프트웨어 패키지 [25]를 사용하여 믿을 수있는 세부 사항을 상상하고 그릴 수 있습니다.

이 논문에서는 로그 가능성 목표 (log-likelihood objective)를 사용하여 엔드 투 엔드 (end-to-end) 훈련을받은 완전히 확률 론적 인 모델이 그림 1 중간 열에 묘사 된 32 ~ 32 개의 얼굴 이미지를 합성함으로써 그러한 아티스트의 역할을 수행 할 수있는 방법을 보여줍니다. 이 모델에서 여러 개의 샘플을 그리는 것은 저해상도 이미지와 일치하는 이미지의 다양성과 유사한 다중 모달을 나타내는 고해상도 이미지를 생성합니다. 인간 평가 연구에서 우리는 순진한 관찰자가 심층 네트워크 및 평균 제곱 오차 (mean squared error, MSE) 목표를 사용하여 정교한 수퍼 해상도 모델의 출력으로부터 실제 이미지를 쉽게 구별 할 수 있음을 보여줍니다 [21]. 그러나 우리의 확률 론적 모델에서 추출 된 샘플은 시간의 27 : 9 %까지 인간 관찰자를 속일 수 있습니다 - 확률은 50 %입니다.

요약하면이 논문의 주요 공헌 내용은 다음과 같다.

? 다차원 예측의 관점에서 underspecified super resolution 문제의 특성화.

? 다양하고, 그럴듯하고, 모호하지 않은 고해상도 샘플을 생성하는 초고 해상 문제에 맞춘 새로운 확률 모델의 제안.

? 컨디셔닝 신호가 무시되는 것을 피하기 위해 강력한 자동 회귀 형 디코더를 사용하여 조건부 확률 모델에 대한 새로운 손실 조건을 제안합니다.

? 수퍼 해상도 (예 : pSNR 및 SSIM)의 기존 메트릭이 명시되지 않은 수퍼 해상도의 영역에서 샘플 품질을 캡처하지 못하는 것을 보여주는 사람 평가.

우리는 관련 작업에 대해 설명하고,이어서 다중 목적 문제가 전통적인 목표를 사용하여 다루어지지 않는 방법을 설명합니다. 그런 다음 ResNet [14]과 Pixel-CNN [43] 위에 새로운 확률 모델을 제안한다. 이 논문은 모델에 의해 생성 된 고해상도 샘플의 다양성을 강조하고 인간 평가 연구를 통해 샘플의 품질을 입증합니다.


2. 관련 연구

슈퍼 해상도는 컴퓨터 비전에서 오랜 역사를 가지고 있습니다 [31].

보간법 [15]에 의존하는 방법은 구현하기 쉽고 광범위하게 사용되지만 선형 모델은 입력과 출력 사이에 복잡한 종속성을 표현할 수 없으므로 표현 방법이 부족합니다.

실제로 이러한 방법은 종종 고주파 세부 사항을 적절히 예측하지 못하여 고해상도 출력이 흐릿 해집니다.

Sparsity [2] 또는 Gaussian mixture [51]와 같은 풍부한 이미지 사전을 사용하여 선형 방법을 향상 시키면 메소드의 품질이 크게 향상됩니다. 마찬가지로 에지 그라디언트와 같은 낮은 수준의 이미지 통계를 활용하면 예측이 향상됩니다 [47, 41, 8, 16, 39, 22]. 패치 데이터베이스를 검색하고 확대 된 이미지에서 그럴듯한 고주파수 세부 정보를 생성하기 위해이를 결합하는 알고리즘에 대한 많은 작업이 수행되었습니다 [9, 17]. 최근의 패치 기반 작업은 이미지에 미리 학습 된 필터 사전을 구축하고 효율적인 해싱 메커니즘 [34]을 사용하여 적절한 패치를 선택함으로써 기본 보간 방법을 개선하는 데 중점을 두었습니다.

이러한 사전 방법은 추론 속도를 향상시키면서 최첨단 기술과 비교할 수 있습니다.

초 해상도에 대한 또 다른 접근법은 추론 속도 요구 사항을 포기하고 점점 더 높은 배율로 고해상도 이미지를 만드는 데 집중하는 것입니다. Convolutional Neural Network (CNN)는 명백한 사전 구성을 피하는 문제에 대한 접근 방식을 나타내지 만 필터 커널 계층을 학습하여 여러 추상 계층을 암시 적으로 추출합니다.

Dong et al. [7]

MSE 손실로 3 층 CNN을 사용했다.

Kim et al. [21]

깊이를 20 층으로 늘리고 고해상도 이미지와 보간 된 저해상도 이미지 사이의 잔차만을 학습함으로써 정확도가 향상되었습니다.

가장 최근에 SRResNet [26]은 많은 ResNet 블록을 사용하여 표준 수퍼 해상도 벤치 마크에서 최신 pSNR 및 SSIM을 얻었습니다. 우리는 조건부 네트워크와 포괄적 회귀 분석 기준을 위해 유사한 설계를 채택했습니다.

픽셀 당 손실을 사용하는 대신 존슨 (Johnson) 등 [18]

모델의 예측과 지상 진실 이미지에 대해 사전 훈련 된 CNN의 활성화 사이의 유클리드 거리를 사용합니다.

이 소위 지각 손실을 사용하여 수퍼 해상도 및 스타일 전송을 위해 피드 포워드 네트워크를 교육합니다. Bruna et al. [4]

또한 지각 손실을 사용하여 수퍼 해상도 네트워크를 학습하지만 추측은 저해상도 입력 (예 : [12])으로 그라디언트 전파를 통해 수행됩니다.

또 다른 유망한 방향은 네트워크 교육에 적대적 손실을 사용하는 것이 었습니다. 초 고해상도 네트워크는 합성 된 고해상도 이미지가 실제인지 또는 가짜인지 여부를 구별하려는 보조 네트워크에 대해 교육을받습니다.

전통적인 Lp 손실로 훈련 된 네트워크 (예 : [21, 7])는 흐릿한 이미지로 고통을 겪습니다. 네트워크가 적대적 손실을 사용함에 따라 매력적이고 고주파의 세부 사항을 예측합니다 [26, 49]. Sønderby et al. [19]

적대적 손실에 대한 교육을 받았지만 네트워크가 저해상도 입력으로 다운 스케일링 된 이미지 만 생성하도록하는 affine 변환을 학습하도록 제한했습니다. Sønderby et al. [19]

또한 마스킹 된 자동 회귀 모델을 탐색하지만 게이트 된 레이어가 없으며 다항 분포 대신 가우스 혼합을 사용합니다. Denton et al. [5]

슈퍼 해상도 작업에 적합한 이미지 합성을 위해 다중 스케일의 적대적 네트워크를 사용하십시오.

비록 generative adversarial networks (GANs) [13]가 유망한 방향을 제공하지만, 그러한 네트워크는 몇 가지 결점이있다. 첫째, 적대적인 네트워크를 훈련하는 것이 불안정하며 훈련의 견고성을 높이기위한 많은 방법이 개발되고있다.

둘째, GAN은 결과 모델이 훈련 데이터에서 사용 가능한 샘플의 다양성을 포착하지 않는 샘플을 생성하는 모드 붕괴의 일반적인 실패 사례로 고통받습니다.

마지막으로, 적대적인 네트워크의 성능을 추적하는 것은 결과에 확률 론적 해석을 연관시키는 것이 어렵 기 때문에 어렵습니다. 이러한 점들은 훈련 데이터 세트의 모든 다양성을 포괄 할 수있는 뚜렷한 접근법으로 문제에 접근하도록 동기를 부여합니다.

PixelRNN과 PixelCNN [43, 44]은 긴 순서로 표현하기 위해 이미지 픽셀에 순서를 부여하는 확률 생성 모델이다. 후속 픽셀의 확률은 이전에 관찰 된 픽셀을 조건으로합니다.

PixelCNN [44]의 한 변종은 CIFAR-10 및 MNIST와 같은 학문적 벤치 마크에서 로그 가능성 (log-likelihood)과 관련하여 최첨단 예측 능력을 얻었습니다. Pixel-CNN은 학습을위한 대수 우도 (log-likelihood)를 사용하므로 무시할 수있는 확률이 학습 예제에 할당되면 모델에 불이익을줍니다.

대조적으로, 적대적인 네트워크는 비 - 고정형 판별자를 속일만큼 배울뿐입니다. 이 후자의 지적은 PixelCNN이 주어진 저해상도 이미지와 관련 될 수있는 고해상도 이미지의 큰 다양성을 예측할 수 있음을 암시합니다.

또한, 학습 목표로 로그 가능성 (log-likelihood)을 사용하면 하이퍼 링크
매개 변수 검색을 사용하여 검증 세트에서 로그 확률을 단순히 비교하여 모델 패밀리 내에서 모델을 찾습니다.


3. 확률 론적 초 해상력

우리는 고해상도 이미지와 해당 저해상도 이미지 사이의 통계적 종속성을 식별하는 확률 적 슈퍼 해상도 모델을 학습하는 것을 목표로합니다.

x와 y를 저해상도와 고해상도 이미지라고하고, y? 지상 진실 고해상도 이미지를 나타냅니다.

p? (y j x)의 파라 메트릭 모델을 배우기 위해, 우리는 D와 같이 표시된 저해상도 입력과 지반 진리 고해상도 출력의 큰 데이터 세트를 이용합니다. f (x (i), y (i)) gNi = 1이다.

일부 고해상도 이미지에서 시작하여 필요한만큼 해상도를 낮춤으로써 이러한 대형 데이터 세트를 쉽게 수집 할 수 있습니다.

매개 변수를 최적화하려면? 조건부 분포 p의 조건부 로그 가능성 (logal likelihood) 조건을 최대화하면,

O( j D) =
X
(x;y)2D
log p(y j x) : (1)

이 논문에서 논의 된 핵심 문제는 현실적인 흐리지 않은 출력을 생성하면서 효율적인 학습과 추론을 가능하게하는 정확한 형태의 p (y j x)이다. 우리는 먼저 각 출력 픽셀이 입력이 주어진 독립적 인 확률 과정으로 생성된다고 가정하는 픽셀 독립 모델을 논의합니다. 우리는 왜 이러한 기법들이 흐릿한 초고 해상 결과를 초래하는지 자세히 설명합니다.

그런 다음 출력 픽셀 간의 통계적 종속성을 모델링 할 수 있도록 한 번에 하나씩 출력 픽셀을 생성하는 픽셀 재귀 슈퍼 해상도 모델을 설명합니다. 이렇게하면 매우 낮은 해상도의 입력이 주어지는 날카로운 합성 이미지가 생성됩니다.


3.1. 픽셀 독립적 인 수퍼 해상도

확률 적 수퍼 해상도 모델의 가장 간단한 형태는 출력 픽셀이 입력을 조건부로 독립적이라고 가정합니다. 이와 같이, p (y j x)의 조건부 분포는 독립적 인 픽셀 예측의 결과로 작용한다.

RGB 출력 y가 각각 3 개의 컬러 채널, 즉 y2R3M을 갖는 M 픽셀을 갖는다고 가정하자. 그때,

log p(y j x) =
X3M
i=1
log p(yi j x) : (2)

문헌에서 픽셀 예측 모델의 두 가지 일반적인 형태가 연구되어왔다 : 연속 및 이산 픽셀 값을 각각 모델링하기위한 가우시안 분포 및 다항 분포.

가우스의 경우,

log p(yi j x) = 􀀀
1
22
kyi 􀀀 Ci(x)k22
􀀀 log
p
22 ; (3)

Ci (x)는 컨벌루션 뉴럴 네트워크 (convolutional neural network)를 통해 x의 비선형 변환의 i 번째 요소를 나타낸다. 따라서, Ci (x)는 i 번째 출력 픽셀 yi에 대한 추정 된 평균이고, σ2는 분산을 나타낸다.

흔히 분산은 배제되지 않으며,이 경우 (1)의 조건부 로그 가능성을 최대화하면 데이터 집합 전체의 픽셀과 채널에서 yi와 Ci (x) 사이의 MSE가 최소화됩니다.

MSE 회귀에 기반한 초 해상도 모델은 픽셀 독립 모델 군에 속한다 [7, 21, 26].

암시 적으로, 신경망의 출력은 고정 된 분산을 갖는 가우시안 세트를 매개 변수화합니다.

접합 분포 p (yj x)가 등방성 다 변량 가우시안을 형성하기 때문에 단봉 적이라는 것을 검증하는 것은 쉽습니다.

대안 적으로, 출력 치수를 K 가능한 값들 (예를 들어, K = 256)로 분리 할 수 ​​있고, 각 픽셀 [50]에 대한 예측 모델로서 다항 분포를 사용할 수 있으며, 여기서, yi2f1; : : : ;킬로그램. 다항식 softmax 연산자에 기반한 픽셀 예측 모델은 다음과 같이 표현된다.

p(yi = k j x) =
expfCik(x)g
PK
v=1 expfCiv(x)g
; (4)

컬러 채널 당 각 값에 대해 softmax 가중치 세트 fwjkg3, Kj = 1, k = 1을 갖는 네트워크가 Cik (x)를 유도하는 데 사용됩니다.

식 (4)의 p (yi jx)가 다중 모드 분포를 나타낼 수 있지만, 픽셀 들간의 조건부 의존성은 포착 될 수 없다. 즉, 모델은 샘플 들간의 조정을 필요로하기 때문에 하나의 위치에서 에지를 그리는 것과 다른 위치에서 에지를 그리는 것 사이에서 선택할 수 없다.

====================================

데이터 세트 생성 방법
50 %
50 %
훈련 된 모델의 샘플
L2 회귀 분석
교차 엔트로피
PixelCNN

그림 2 : 시뮬레이션 된 데이터 세트는 멀티 모달 예측의 문제점을 보여줍니다.

Top : 샘플을 무작위로 왼쪽 위 또는 오른쪽 아래 모서리로 변환하는 합성 데이터 세트입니다.

아래 :이 데이터 세트에서 교육 된 다양한 알고리즘에 대한 예측 예입니다.

픽셀 독립적 인 L2 회귀 및 교차 엔트로피 모델은 단일 모드를 예측하지 못하고, 대신 그러한 샘플이 트레이닝 세트에 존재하지 않더라도 두 개의 공간 위치의 블렌드를 예측합니다.

반대로, PixelCNN은 상호 배제 된 어느 한 구석에서의 자리 위치를 확률 적으로 예측합니다.

========================================


3.2. 합성 멀티 모달 작업

조건부 이미지 모델링에서 픽셀 독립 모델이 어떻게 실패 하는지를 보여주기 위해 명시 적으로 멀티 모드 예측이 필요한 합성 데이터 세트를 만듭니다. 많은 고밀도 이미지 예측 작업 (예 :

super resolution [31], colorization [50,6], 그리고 depth estimation [37]과 같이 단일 모드를 예측할 수있는 모델은 모드를 함께 혼합하는 모델보다 훨씬 선호됩니다. 예를 들어, 색상 지정 작업에서 사과에 강한 빨간색 또는 녹색을 선택하는 것은 훈련 세트에서 관찰 된 모든 사과 색상의 번짐 평균을 반영하는 갈색 톤 색상을 선택하는 것보다 낫습니다.

우리는이 문제의 도전을 증명하기 위해 간단한 멀티 모달 MNIST 모서리 데이터 세트를 구성한다.

MNIST 모서리는 MNIST 숫자를 왼쪽 상단 또는 오른쪽 하단 모서리에 무작위로 배치하여 구성됩니다 (그림 2, 상단). 몇 가지 네트워크는이 간단한 예제의 고유 한 문제를 보여주기 위해이 데이터 세트의 개별 샘플을 예측하도록 훈련되었습니다.

이 장난감의 예는 네트워크가 이미지 구석에있는 개별 숫자를 독점적으로 예측하는 것입니다.

L2 목적 (즉, MSE 회귀)을 갖는 보통 크기의 10- 레이어 컨벌루션 뉴럴 네트워크 (100K 파라미터)를 트레이닝하면, 2 개의 모드가 함께 블렌딩 된 흐린 이미지 샘플이 생성된다 (도 2, L2 회귀).

즉, 예제 이미지에 양쪽 모서리에 숫자가 포함 된 데이터 세트는 없지만이 모델은 이러한 샘플의 혼합을 잘못 예측합니다. 손실을 개별 픽셀 단위 교차 엔트로피로 대체하면 더 선명한 이미지가 생성되지만 이미지의 구석에있는 숫자를 확률 적으로 예측하지는 못합니다 (그림 2, 크로스 엔트로피).


4. 픽셀 반복적 인 수퍼 해상도

예측 된 픽셀들 사이의 조건 적 독립성의 결여는 합성 예 (식 3 및 4)에서 이전의 확률 적 목적에 대한 중요한 실패 모드이다.

이 문제에 대한 하나의 접근법은 출력 픽셀의 조건부 분포를 다중 변수 Gaussian 혼합물 [52] 또는 무향 그래픽 모델 [10]로 공동으로 정의하는 것입니다.

이러한 조건부 분포 모두는 추론이 계산적으로 비쌀 수있는 출력 픽셀간에 통계적 종속성을 구성해야합니다.

두 번째 접근법은 이미지 픽셀에 순서를 부과하여 체인 규칙을 사용하여 접합 분포를 분해하는 것입니다.

log p(y j x) =
MX
i=1
log p(yi j x; y<i) ; (5)

여기서 각 출력 차원의 생성은 입력 및 이전 출력 픽셀을 조건으로한다 [24, 42].

조건 1을 픽셀 i까지 y <i로 나타냅니다. 여기서 fy1; : : :; yi􀀀1g.

이 접근 방식의 이점은 조건부 종속성의 정확한 형태가 유연하고 추론이 간단하다는 것입니다.

PixelCNN은 로그 p (yi j x; y <i)에 대한 명쾌한 모델을 교묘하게 마스크 된 컨볼 루션의 게이트 된 계층 적 체인으로 제공하는 확률 적 모델입니다 [43, 44, 36].

PixelCNN의 목표는 이미지에서 다중 모드 및 캡처 픽셀 상관 관계를 캡처하는 것입니다.

사실, MNIST 코너 데이터 세트에서 PixelCNN을 교육하면 문제의 바이 모달을 성공적으로 캡처하고 숫자가 단일 모서리에만있는 샘플을 생성합니다 (그림 2, Pixel-CNN).

중요하게도이 모델은 두 숫자를 동시에 예측하지 않습니다.


=======================================
1 컬러 이미지에서 컬러 채널뿐 아니라 공간 위치에도 순서를 지정해야한다는 점을 참고하십시오. 컬러 이미지에서 컨디셔닝은 동일한 공간 위치의 픽셀뿐만 아니라 이전의 공간 위치에서 입력 및 이전에 출력 된 픽셀을 기반으로합니다.

이전 네트워크!
(PixelCNN)
로지 HR!
영상
조절!
네트워크 (CNN)!
+ 인사!
영상

그림 3 : 제안 된 초고 해상도 네트워크는 컨디셔닝 네트워크와 이전 네트워크로 구성됩니다.

컨디셔닝 네트워크는 입력으로 저해상도 이미지를 수신하고 각 고해상도 (HR) 이미지 픽셀의 조건부 로그 확률을 예측하는 로그를 출력하는 CNN입니다.

이전 네트워크 인 PixelCNN [44]은 이전의 확률 적 예측 (점선으로 표시)을 기반으로 예측을합니다.

모델의 확률 분포는 이전 및 컨디셔닝 네트워크의 두 세트의 로짓의 합계 위에 softmax 연산자로 계산됩니다.

======================================

초 해상도 문제에 PixelCNN을 적용하는 것은 이미지의 저해상도 버전에서 컨디셔닝을 제공하기 위해 아키텍처를 수정해야하는 간단한 애플리케이션입니다.

초기 실험에서 우리는 모델의 자동 회귀 분포가 저해상도 이미지의 컨디셔닝을 대부분 무시한다는 것을 발견했습니다.

"최적화 문제"라고 불리는이 현상은 순차 자동 인코딩 모델 [3] ([38, 40] 참조)의 컨텍스트에서 쉽게 문서화되었습니다.

이 문제를 해결하기 위해 PixelCNN의 아키텍처를 수정하여 저해상도 이미지의 컨디셔닝에보다 명시 적으로 의존합니다.

특히 우리는 문제를 자동 회귀 및 조절 요소로 간주하는 후기 융합 모델을 제안한다 (그림 3).

이전 네트워크라고하는 모델의 자동 회귀 부분은 픽셀의 직렬 종속성을 캡처하는 반면 컨디셔닝 구성 요소라고하는 컨디셔닝 구성 요소는 저해상도 이미지의 전체 구조를 캡처합니다.

특히, 우리는 이전의 네트워크를 PixelCNN으로 만들고 컨디셔닝 네트워크를 초 해상도를 위해 이전에 사용 된 깊은 컨볼 루션 네트워크로 공식화한다 [26].

주어진 입력 x 2 RL, Ai (x) : RL! RK는 i 번째 출력 픽셀이 취할 수있는 K 개의 가능한 값에 해당하는 로짓 값의 벡터를 예측하는 컨디셔닝 네트워크를 나타냅니다. 비슷하게, Bi (y <i) : Ri􀀀1! RK는 i 번째 출력 픽셀에 대한 로짓 값의 벡터를 예측하는 이전 네트워크를 나타냅니다.

우리의 확률 론적 모델은 두 세트의 로그를 추가하고 softmax 연산자를 적용함으로써 i 번째 출력 픽셀에 대한 분포를 예측한다.

p(yi j x; y<i) = softmax(Ai(x) + Bi(y<i)) : (6)

A와 B의 파라미터를 공동으로 최적화하기 위해, (1)에서 조건부 로그 우도를 최대화하기 위해 확률 적 그라디언트 상승을 수행합니다.

즉, 식 (6)에서 모델의 예측과 이산 된지면 진리 레이블 yi 2 f1 사이의 교차 엔트로피 손실을 최적화합니다. : : : ;킬로그램,

O1 =
X
(x;y)2D
MX
i=1

1[y
i ]T(Ai(x) + Bi(y
<i))
􀀀 lse(Ai(x) + Bi(y
<i))

;
(7)

여기서, lse (ω)는 소프트 맥스의 분모의 로그에 대응하는 log-sum-exp 연산자이고, 1 [k]는 k 차원을 1로 설정 한 K 차원 일 핫 표시기 벡터를 나타낸다.

우리의 예비 실험은 (7)로 훈련 된 모델이 픽셀과 이전의 고해상도 픽셀 사이의 통계적 상관 관계가 저해상도 입력과의 상관 관계보다 강하기 때문에 컨디셔닝 네트워크를 무시하는 경향이 있음을 나타냅니다.

이 문제를 완화하기 위해 컨디셔닝 네트워크의 최적화를 강화하려는 우리의 목표에 추가적인 손실이 있습니다. 이 추가 손실은 softmax (Ai (x)) 및 접지 진실 레이블을 통한 컨디셔닝 네트워크의 예측 간의 교차 엔트로피를 측정합니다.

실험에서 최적화 된 총 손실은 다음과 같이 공식화 된 두 가지 교차 엔트로피 손실의 합입니다.

O2 =
X
(x;y)2D
MX
i=1

1[y
i ]T(2Ai(x) + Bi(y
<i))
􀀀 lse(Ai(x) + Bi(y
<i)) 􀀀 lse(Ai(x))

:
(8)

일단 네트워크가 훈련되면 모델로부터 샘플링하는 것은 간단합니다.

i = 1에서 시작하여 (6)을 사용하여 먼저 고해상도 픽셀을 샘플링합니다. 그런 다음 픽셀 단위로 진행하고 이전에 샘플링 한 픽셀 값을 네트워크로 다시 공급하고 새로운 고해상도 픽셀을 그립니다.

각 픽셀의 3 개 채널이 순차적으로 차례로 생성됩니다.

부가 적으로 우리는 가장 큰 확률을 갖는 픽셀 값을 선택하고, 온도 p를 사용하여 분포 p의 농도가 조정되는 조정 된 소프트 맥스로부터 샘플링하는 욕심 디코딩을 고려한다. > 0,

p =
p(1=)
kp(1=)k1
:

샘플링 분포 p (yi j x; y <i)의 농도를 제어하려면 A와 B의 로그를 매개 변수로 나누면 됩니 다. . 참고로? 0으로 갈 때 분포는 모드로 수렴됩니다.


4.1. 구현 세부 사항

우리는 픽셀 재귀 슈퍼 해상도 모델을위한 네트워크 아키텍처를 요약한다.

컨디셔닝 아키텍처는 디자인면에서 SRResNet [26]과 유사합니다.

컨디셔닝 네트워크는 일련의 18 × 30 ResNet 블록 [14]과 전환 된 컨볼 루션 레이어 [32]를 통해 저해상도 이미지를 취하는 피드 포워드 컨벌루션 신경망입니다.

마지막 층은 각 서브 - 픽셀에 대해 256 개의 가능한 컬러 채널 값에 대한 다항 분포를 예측하기 위해 채널 수를 증가시키기 위해 1 대 1 컨볼 루션을 사용한다.

이전의 네트워크 아키텍처는 각 레이어에서 32 개의 채널을 갖는 20 개의 게이트 된 PixelCNN 블록으로 구성됩니다 [44].

수퍼 - 해상도 네트워크의 최종 계층은 컨디셔닝 및 이전 네트워크로부터의 활성화의 합계에 대한 softmax 동작이다.

이 모델은 TensorFlow [1]를 사용하여 구축되었으며 동기 SGD 업데이트가있는 8 개의 GPU에 대해 교육을 받았습니다.

교육 세부 정보 및 아키텍처 매개 변수의 전체 목록은 부록 A를 참조하십시오.


5. 실험

우리는 중앙에서 자른 얼굴 (CelebA [27])과 침실 이미지 (LSUN Bedrooms [48])를 포함하는 두 개의 데이터 세트에서 제안 된 픽셀 재귀 슈퍼 해상도 방법의 유효성을 평가합니다.

두 데이터 세트에서 우리는 이미지를 8- 8 및 32-32 픽셀로 바이 큐빅 보간법으로 크기 조정하여 교육 및 평가를 위해 입력 x 및 출력 y를 제공합니다.

우리는 (1) Nearest N.;

예제 기반의 초 해상도에 대한 이전 연구에서 영감을 얻은 가장 가까운 이웃 탐색 기준 [9], (2) ResNet L2; MSE 목표로 훈련 된 Resnet 블록을 사용한 심 신경 네트워크, 그리고 (3) GAN; [49]와 유사한 [11]에 의해 구현 된 GAN 기반의 초고 해상 모델. 침실 데이터 세트의 GANbaseline 결과는 경쟁력이 없으므로 제외시키고 모델은 얼굴 전용으로 개발했습니다.

Nearest N. baseline은 트레이닝 세트를 검색하여 샘플 x에 대한 y를 계산한다. i = 1로 인덱싱 된 가장 가까운 예제에 대해 gNi = 1이다. = argminikx (i) 􀀀 xk22이고, 고해상도 대응 물 y ∈ (i?)를 리턴한다.

Nearest N. baseline은 모형 기반의 초고 해상 접근법의 대표적인 결과이며 모델이 훈련 데이터 세트에서 순진한 조회를 수행하는지 여부를 테스트하는 데 도움이됩니다.

ResNet L2 기준선은 SRResNet [26]과 유사한 디자인을 사용하여 이미지 유사성 측정 기준에 관한 최첨단 기술을보고합니다 2.

가장 중요한 것은 입력의 2 차 보간과 관련하여 잔차를 계산하도록 네트워크를 변경합니다 [21]. L2 회귀 분석은 단일 모드 픽셀 독립 예측을 수행하는 최첨단 컨볼 루션 네트워크와의 비교를 제공합니다.

GAN 수퍼 해상도 기준선은 조건부 GAN 아키텍처를 이용하고 adversarial 손실과 일관성 손실을 결합하여 예측 된 y의 저해상도 버전을 L1에 의한 측정 값으로 x에 가깝게 만듭니다.

[11]에 의해 지정된 두 손실 사이의 가중치는 일관성에 대해 0 : 9이고 적 당 손실에 대해 0 : 1로, 우리는 얼굴 실험에서 동일하게 유지합니다.

==================================================

2 회귀 구조는 4.1 절의 조절 네트워크와 거의 동일하다는 점에 유의하십시오.

약간의 변경은 네트워크가 RGB 공간에서 경계 값을 예측하도록 강제하는 것입니다.

이 동작을 강화하기 위해, 최상위 계층은 하나 대신 3 개의 채널을 출력하고 ReLU (?) 비선형 성 대신 tanh (?)를 사용합니다.

그림 4 : LSUN Bedrooms 데이터 세트에서 엔드 투 엔드 (end-to-end) 훈련 된 확률 적 픽셀 재귀 슈퍼 해상도 모델의 예

==================================================


5.1. 수퍼 해상도 샘플

픽셀 반복적 인 수퍼 해상도에 의해 생성 된 고해상도 샘플은 데이터 세트의 풍부한 구조를 포착하고 지각 적으로 그럴듯한 것처럼 보입니다 (그림 1 및 4, 부록 B 및 C).

수퍼 해상도 모델에서 여러 번 샘플링하면 주어진 저해상도 이미지에 대해 다른 고해상도 이미지가 생성됩니다 (그림 5, 부록 B 및 C). 정 성적으로, 모델의 샘플은 주어진 저해상도 이미지에 상응하는 뚜렷한 정성적인 특징을 가진 많은 그럴듯한 고해상도 이미지를 식별합니다.

얼굴 데이터 세트의 샘플 간 차이점은 완전 실패를 나타내는 모드를 완전히 예측하지 못하는 실패를 나타내는 합성 데이터 세트보다 훨씬 덜 과감하다는 점에 유의하십시오.

표본의 품질은 온도에 민감합니다 (그림 6, 오른쪽 열).

Greedy 디코딩 (? = 0)은 지나치게 매끄 럽고 수평 및 수직 라인 아티팩트가 포함 된 품질이 떨어지는 샘플을 생성합니다.

기본 온도 (= 1 : 0)의 샘플은 바람직하지 않은 고주파수 내용을 포함하는 경향이 있지만 지각 적으로 더 그럴듯합니다.

0 : 9에서 0 : 8 사이의 온도 (?)를 튜닝하면 샘플의 품질을 향상시키는 데 유리합니다.

============================================

그림 5 : 픽셀 재귀 슈퍼 해상도 모델의 샘플 다양성. 왼쪽 열 : 저해상도 입력.

오른쪽 열 : 여러 수퍼 해상도 샘플? = 0 : 8은 저해상도 입력시 컨디셔닝됩니다.
==============================================


5.2. 이미지 유사성의 정량적 평가

유사성에 대한 인간의 지각 판단을 측정하는 영상 유사성을 정량화하는 방법은 많습니다 [45, 46, 28].

우리는 pSNR과 MS-SSIM(표 1)을 이용하여 지상의 진실에 비해 예측 정확도를 정량화했다. 예측된 영상 화질에 대한 자체 시각적 평가는 이러한 영상 유사성 메트릭스와 일치하지 않는다는 것을 발견했습니다. 예를 들어, 양면 내삽은 표본이 매우 빈약해 보였지만 상대적으로 높은 측정지표를 달성했다.

이러한 결과는 새로운 세부 정보가 합성될 때 pSNR과 SSIM이 슈퍼 해상도 품질의 좋지 않은 판단을 제공한다는 최근 관찰과 일치합니다 [26, 18].

또한 그림 6은 모델 샘플의 인지 품질이 반드시 음의 로그 가능성(NLL)과 일치하지 않는 방법을 강조합니다.

NLL이 작다는 것은 모형이 해당 이미지에 더 큰 확률 질량을 할당했음을 의미합니다.

더 나쁜 지각적 성질을 보이고 있음에도 불구하고 욕심 많은 양면, 그리고 퇴보적인 면들은 모델에 의해 선호된다.

다음으로 우리는 일관성을 측정하여 고해상도 샘플이 저분해능 입력에 얼마나 잘 대응하는지 측정했다.

일관성은 저해상도 입력 이미지와 고분해능 추정치의 이항식 하향 샘플링된 버전 사이의 L2 거리로 정량화됩니다.

일관성이 낮으면 저해상도 이미지와 더 잘 일치하는 것을 나타냅니다.

이는 GAN[11]의 명시적 목표입니다.

달성된 픽셀 재귀 모델은 L2 회귀 모형 및 바이큐빅 보간법과 동등하게 연속성을 달성했는데, 이는 비록 모델이 다양한 샘플을 생산하고 있지만 샘플이 저분해능 이미지에 의해 크게 제약된다는 것을 나타냅니다.

가장 중요한 것은 픽셀 재귀 모델이 이 기준에 대해 명시적으로 최적화하지 않더라도 GAN [11]보다 우수한 연속성을 달성했다는 점입니다.3

일관성 측정은 픽셀 재귀 모델이 가장 가까운 교육 샘플을 단순하게 복사하는지 여부를 결정하기 위한 중요한 제어 실험을 추가로 제공했습니다.

픽셀 반복 모형이 가장 가까운 교육 샘플을 복사했을 때 가장 가까운 N의 일관성을 유지합니다.

모델은 픽셀 재귀 모델과 동일합니다.

대신 픽셀 재귀 모델이 가장 가까운 교육 예제를 단순하게 복사하는 것이 아니라는 것을 나타내는 우수한 일관성 값을 가지고 있다는 것을 알게 됩니다.


5.3. 인간과 지각 평가

자동화 된 정량적 측정이 우리의 지각적 판단과 일치하지 않는다는 것을 감안할 때, 우리는 초고 해상 알고리즘의 효율성을 평가하기위한 인체 연구를 수행했다.

특히 우리는 주어진 고해상도 표본이 각 모델에서 얼마나 그럴듯한지를 결정하기 위해 군중 출신 근로자에 대한 강제 선택 실험을 수행했습니다.

[50]에 따라, 각 근로자는 모델로부터 참된 이미지와 상응하는 예측을 제시하고 "어떤 이미지를 추측하겠습니까?"라고 물었습니다.

우리는 Amazon Mechanical Turk의 283 명의 작업자에 대해이 연구를 수행했으며 각 초 고해상도 알고리즘에 대해 40 명의 고유 작업자에 대한 통계가 발생했습니다 .4

==============================
3 GAN의 일관성을 향상 시키려면 목표에서 그 무게를 늘려야한다고 언급한다.

일관성 용어의 가중치를 높이면 이미지의 지각 품질이 저하되지만 일관성은 향상됩니다.

그럼에도 불구하고, 픽셀 재귀 모델에 의해 생성 된 이미지는 온도 범위에 대해 판단 된 인간과 같이 일관성 및 지각 품질이 모두 우수합니다.

4 특히, 각 근로자에게는 강제 선택 결정을 내릴 때 1 초가 주어진다.

노동자들은 10 회의 연습 문제로 세션을 시작하여 피드백을 받았습니다.

연습 쌍은 결과에 포함되지 않았습니다.

연습 쌍 후에, 각 노동자는 45 쌍을 추가로 보였다.

쌍의 부분 집합은 근로자가주의를 기울이고 있는지 끊임없이 확인하도록 고안된 간단하고 황금색 질문이었습니다. 골든 질문에 잘못 대답 한 근로자의 데이터가 삭제되었습니다.
=============================

=====================================
그림 6 : 수퍼 해상도 모델의 비교. 왼쪽에서 오른쪽으로의 열은 입력, Ground truth, Nearest N을 포함합니다.

(가장 근접한 슈퍼 해상도), GAN, 바이 큐빅 업 샘플링, ResNet L2 (MSE로 최적화 된 신경망), 그리 디 디코딩은 픽셀 재귀 모델이며, 예측 분포의 농도를 제어하는 다양한 온도 (?)로 샘플링됩니다.

음의 로그 확률은 이미지 아래에보고됩니다.

최상의 로그 확률은 이미지의 품질이 좋지 않더라도 바이 큐빅 업 샘플링 및 그리 디 디코딩과 관련됩니다.

===================================


===================================
CelebA pSNR SSIM MS-SSIM 일관성 % 속임수
바이 큐빅 28.92 0.84 0.76 0.006 -
가장 가까운 N. 28.18 0.73 0.66 0.024 -
ResNet L2 29.16 0.90 0.90 0.004 4 : 0? 0 : 2
GAN [11] 28.19 0.72 0.67 0.029 8 : 5? 0 : 2
? = 1 : 0 29.09 0.84 0.86 0.008 11 : 0? 0 : 1
? = 0 : 9 29.08 0.84 0.85 0.008 10 : 4? 0 : 2
? = 0 : 8 29.08 0.84 0.86 0.008 10 : 2? 0 : 1
LSUN pSNR SSIM MS-SSIM 일관성 % 속임수
바이 큐빅 28.94 0.70 0.70 0.002 -
가장 가까운 N. 28.15 0.49 0.45 0.040 -
ResNet L2 28.87 0.74 0.75 0.003 2 : 1? 0 : 1
? = 1 : 0 28.92 0.58 0.60 0.016 17 : 7? 0 : 4
? = 0 : 9 28.92 0.59 0.59 0.017 22 : 4? 0 : 3
? = 0 : 8 28.93 0.59 0.58 0.018 27 : 9? 0 : 3

======================================

표 1 : 자른 CelebA (상단) 및 LSUN 침실 (하단) 데이터 세트의 테스트 결과는 8-8에서 32-32로 확대되었습니다.

우리는 샘플과 지상 진실 사이에 pSNR, SSIM, MS-SSIM을보고합니다.

일관성은 저해상도 입력과 해당 다운 샘플링 출력 사이의 MSE를 측정합니다.

바보 같은보고는 알고리즘 산출물이 얼마나 많은 사람들이 속한 연구에서 인간을 속일지 측정합니다. 50 %는 완전히 혼란 스러울 것입니다.

표 1은 사람이 실제 이미지라고 잘못 판단한 특정 알고리즘에 대한 샘플 비율을 나타냅니다.

완벽한 알고리즘은 인간을 50 %의 속도로 속일 것임을 주목하십시오. L2 회귀 모델은 인간을 2 ~ 4 % 속이고 GAN은 인간을 속일 때가 8.5 %입니다.

픽셀 재귀 모델은 얼굴과 침실에 대해 각각 11.0 %와 27.9 %의 사람을 속였습니다. 최첨단 회귀 모델보다 훨씬 높습니다.

중요하게도 우리는 샘플링 온도의 선택을 발견 했습니까? 크게 샘플의 품질에 영향을 주었고 인간은 속아 넘어갔습니다.

그럼에도 불구하고 픽셀 재귀 모델은 모든 기온에서 가장 강력한 기본 모델 인 GAN을 능가했습니다.

최고 및 최악의 속이는 예제의 순위 목록은 fool rates와 함께 부록 D에 재현되어 있습니다.


6. 결론

우리는 높은 배율로 누락 된 고해상도에 대한 연구를 주창합니다. 고주파의 세부 사항이 없어지면 문제가 크게 줄어 듭니다.

모호하지 않은 초고 해상 출력물을 생성하는 모든 모델은 누락 된 콘텐츠가 지나치게 복합적으로 작동해야한다는 합리적인 예측을해야합니다. 작은 입력으로 초고 해상을 해결할 수있는 완전히 확률적인 방법을 제시합니다. 8 ~ 8 개의 이미지까지도 32 ~ 32 개의 선명한 이미지로 확대 할 수 있습니다.

우리의 기법은 회귀 대 상을 최적화하는 것 또는 적대적 손실을 포함하여 몇 가지 강력한 기준선을 능가합니다.

우리는 픽셀 재귀 모델의 샘플이 사람에게 더 그럴듯하게 보인다는 것을 보여주는 인간 평가 연구를 수행합니다.보다 일반적으로 pSNR 및 SSIM과 같은 일반적인 측정 기준은 확대 비율이 클 때 인간의 판단과 상관 관계가 없습니다.


감사 인사

감사의 말과 토론을 위해 Adeon van den Oord, Sander Dieleman 및 Google Brain 팀에 감사드립니다.

